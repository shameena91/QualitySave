{{> admin-header}}
<div class="main-content " id="mainContent">


<h2 class="mb-4">Order Management</h2>

  <!-- Search, Filter, Sort -->
  <form class="row mb-3 g-2" method="get" action="/admin/orders">
    <div class="col-md-3">
      <input type="text" class="form-control" name="search" placeholder="Search Order ID / User" value="{{search}}" />
    </div>
    <div class="col-md-3">
      <select name="statusFilter" class="form-select">
        <option value="">All Statuses</option>
        <option value="Pending">Pending</option>
        <option value="Shipped">Shipped</option>
        <option value="Out for Delivery">Out for Delivery</option>
        <option value="Delivered">Delivered</option>
        <option value="Cancelled">Cancelled</option>
        <option value="Returned">Returned</option>
      </select>
    </div>
    <div class="col-md-3">
      <select name="sort" class="form-select">
        <option value="date_desc">Date: Newest First</option>
        <option value="date_asc">Date: Oldest First</option>
      </select>
    </div>
    <div class="col-md-3 d-flex">
      <button type="submit" class="btn btn-primary me-2">Apply</button>
      <a href="/admin/orders" class="btn btn-secondary">Clear</a>
    </div>
  </form>

  <!-- Orders Table -->
  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-dark">
        <tr>
          <th>Order ID</th>
          <th>Date</th>
          <th>User</th>
            <th>Product</th>
            <th>Quantity</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Change Status</th>
          <th style="width:120px">View</th>
        </tr>
      </thead>
      <tbody class="text-center">
     {{#each products}}
        <tr>
          <td>{{this.orderId}}</td>
          <td>{{this.orderDate}}
            {{this.orderTime}}
          </td>
          <td>{{this.user}}</td>
              <td>{{this.productName}}</td>
                <td>{{this.quantity}}</td>
           
          <td>â‚¹{{this.price}}</td>
          <td>{{status}}</td>
          
          <td style="width:150px">
  <form action="/admin/orders/<%= order._id %>/update-status" method="POST" class="d-flex flex-nowrap align-items-center" style="gap: 4px;">
    <select name="status" class="form-select form-select-sm" style="width: auto; min-width: 120px;">
      <option value="Pending">Pending</option>
      <option value="Shipped">Shipped</option>
      <option value="Out for Delivery">Out for Delivery</option>
      <option value="Delivered">Delivered</option>
      <option value="Cancelled">Cancelled</option>
    </select>
    <button type="submit" class="btn btn-sm btn-success px-2">update</button>
  </form>
</td>
          <td><a href="/admin/order/{{this._id}}" class="btn btn-sm btn-info">View</a></td>
        </tr>
        {{/each}}
     
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      {{#each totalPagesArray}}
      <li class="page-item {{#if (eq this ../currentPage)}}active{{/if}}">
        <a class="page-link" href="?page={{this}}">{{this}}</a>
      </li>
      {{/each}}
    </ul>
  </nav>
</div>

{{>admin-foote}}